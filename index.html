<!DOCTYPE html>
<html>
<head>
    <link rel="manifest" href="/manifest.json">
</head>
<body>
    <h2>Android Chrome Notifications</h2>
    <button onclick="subscribeUser()">Enable Notifications</button>

    <script>
        // 1. Register the Service Worker
        async function registerSW() {
            const registration = await navigator.serviceWorker.register('sw.js');
            return registration;
        }

        const publicKey = 'BAp4s7ddKEtnQHq3uZk2l3yInudMlxREgAyVuPjXvOgvPNuJal4gT1bO6LqcljwS78UXbsL839N_pBo64Hj7y0w';
        
        // 2. Request Permission and Subscribe
        async function subscribeUser() {
            const registration = await navigator.serviceWorker.ready;
            const subscription = await registration.pushManager.subscribe({
                userVisibleOnly: true,
                applicationServerKey: urlBase64ToUint8Array(publicKey)
            });
        
            // CRITICAL: You must copy this JSON from your browser console!
            console.log(JSON.stringify(subscription));
            alert("Check console for subscription object!");
        }
    </script>
</body>
</html>
